<!DOCTYPE html>
<html lang="zh">

<head>
  <!-- Required meta tags always come first -->
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="google-site-verification" content="GgupatpoZgdqsBlxEZoMqGAy3aXAFtXIrYged3SB6EA" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Linux Rootkit检测思路 | nJcx's Blog
</title>
  <link rel="canonical" href="https://www.njcx.bid/posts/T2.html">


  <link rel="apple-touch-icon" href="https://www.njcx.bid/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://www.njcx.bid/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://www.njcx.bid/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="https://www.njcx.bid/manifest.json">
  <meta name="theme-color" content="#333333">

  <link rel="stylesheet" href="https://www.njcx.bid/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://www.njcx.bid/theme/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://www.njcx.bid/theme/css/pygments/emacs.min.css">
  <link rel="stylesheet" href="https://www.njcx.bid/theme/css/style.css">


<meta name="description" content="linux rootkit检测思路 ~">
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?a34c7a96ae9745547c373575407c521f";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

</head>

<body>
  <header class="header">
    <div class="container">
      <div class="row">
        <div class="col-sm-4">
          <a href="https://www.njcx.bid">
            <img class="img-fluid" src=https://www.njcx.bid/images/profile.png width=200 height=200 alt="nJcx's Blog">
          </a>
        </div>
        <div class="col-sm-8">
          <h1 class="title">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<a href="https://www.njcx.bid">nJcx's Blog</a></h1>
          <p class="text-muted">十年生死两茫茫，写程序，到天亮。相顾无言，惟有泪千行</p>
          <ul class="list-inline">
                    <li class="list-inline-item">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<a href="https://www.zhihu.com/people/njcxs" target="_blank">知乎</a></li>
                <li class="list-inline-item"><a href="https://www.anquanke.com/member/154147" target="_blank">安全客</a></li>
                <li class="list-inline-item"><a href="https://www.freebuf.com/column/1481" target="_blank">Freebuf</a></li>
            <li class=" list-inline-item text-muted">|</li>
            <li class="list-inline-item"><a class="fa fa-github" href="https://github.com/njcx" target="_blank"></a></li>
          </ul>
        </div>
      </div>
    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>Linux Rootkit检测思路
</h1>
      <hr>
<article class="article">
  <header>
    <ul class="list-inline">
      <li class="list-inline-item text-muted" title="2022-10-29T20:20:00+03:00">
        <i class="fa fa-clock-o"></i>
        六 29 十月 2022
      </li>
      <li class="list-inline-item">
        <i class="fa fa-folder-open-o"></i>
        <a href="https://www.njcx.bid/category/an-quan.html">安全</a>
      </li>
      <li class="list-inline-item">
        <i class="fa fa-user-o"></i>
        <a href="https://www.njcx.bid/author/njcx.html">nJcx</a>      </li>
      <li class="list-inline-item">
        <i class="fa fa-files-o"></i>
        <a href="https://www.njcx.bid/tag/qi-ye-an-quan-jian-she.html">#企业安全建设</a>      </li>
    </ul>
  </header>
  <div class="content">
    <h4>介绍</h4>
<p>Linux rootkit 是一种特别设计用来隐藏其存在并提供未经授权的系统访问权限的恶意软件。它们对系统的危害很大，通常非常难以检测，因为它们能够修改操作系统的核心组件或关键文件，使得标准的安全检查工具无法发现它们的存在。 主要分为内核态rootkit和用户态rootkit。
无论是用户态rootkit还是内核的rootkit，都会把隐藏自己，作为核心功能存在，只是实现的方法，各有不同。本文的前置知识，建议先阅读：  https://www.njcx.bid/posts/O4.html</p>
<h4>Linux 用户态 rootkit检测</h4>
<p>Linux 用户态 rootkit 主要通过以下几种方法来实现隐藏和操控系统的行为：</p>
<ul>
<li>动态链接库（LD_PRELOAD）注入：通过设置环境变量 LD_PRELOAD 来加载恶意的共享库。这种方法可以拦截并修改标准库函数的行为，例如文件操作、网络通信等，从而隐蔽地执行某些操作。</li>
<li>ptrace系统调用：利用 ptrace 系统调用来跟踪或操控另一个进程。攻击者可以使用这种方法来操纵其他进程的内存或寄存器值，比如篡改程序的返回值或者隐藏特定进程。</li>
<li>/etc/ld.so.preload 植入：在 /etc/ld.so.preload 文件中指定一个共享库，这样每次动态链接器加载程序时都会首先加载这个库。这使得攻击者能够在几乎所有的用户态进程中运行自己的代码。</li>
<li>替换关键系统工具和二进制文件：通过替换常用的系统命令如 ls, ps, netstat 等，使得这些命令在被执行时隐藏特定的信息，例如隐藏特定的文件、进程或网络连接。</li>
<li>劫持环境变量：改变诸如 PATH 这样的环境变量，使得命令行输入的命令指向恶意版本而非原版系统命令。</li>
</ul>
<p>LD_PRELOAD 是 Linux 环境下的一个环境变量，它允许用户指定在执行程序之前优先加载的共享库。这种机制原本是为开发者提供了一种方式来覆盖或扩展标准库函数的功能，比如用于调试、性能监控等。然而，这一特性也可能被恶意利用，特别是通过所谓的 LD_PRELOAD rootkit 来实现未经授权的行为。LD_PRELOAD rootkit 主要通过预加载特定编写的共享库到目标进程的地址空间，从而覆盖或拦截原生系统调用。例如，可以替换文件操作相关的函数（如 open, read, readdir），以便隐藏文件、目录或进程。如果要检测LD_PRELOAD HOOK， 则关注 ld.so.preload 配置文件是不是存在与里面是不是包含so 文件路径地址，以及LD_PRELOAD 环境变量是否存在。</p>
<p>这段代码包含两个函数，用于检查LD_PRELOAD环境变量和配置文件。</p>
<ul>
<li>checkLDPreloadEnv：检查环境变量LD_PRELOAD是否设置。</li>
<li>checkLDPreloadConfig：检查/etc/ld.so.preload文件和/etc/ld.so.conf.d/目录下的配置文件是否包含LD_PRELOAD。</li>
</ul>
<div class="highlight"><pre><span></span><code>func<span class="w"> </span>checkLDPreloadEnv<span class="o">()</span><span class="w"> </span><span class="o">(</span>bool,<span class="w"> </span>string<span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>ldPreload<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>os.Getenv<span class="o">(</span><span class="s2">"LD_PRELOAD"</span><span class="o">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>ldPreload<span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span>true,<span class="w"> </span>ldPreload
<span class="w">    </span><span class="o">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span>false,<span class="w"> </span><span class="s2">""</span>
<span class="o">}</span>

func<span class="w"> </span>checkLDPreloadConfig<span class="o">()</span><span class="w"> </span><span class="o">(</span>bool,<span class="w"> </span><span class="o">[]</span>string<span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>suspiciousFiles<span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="o">[]</span>string<span class="o">{}</span>

<span class="w">    </span>//<span class="w"> </span>Check<span class="w"> </span>/etc/ld.so.preload
<span class="w">    </span><span class="k">if</span><span class="w"> </span>_,<span class="w"> </span>err<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>os.Stat<span class="o">(</span><span class="s2">"/etc/ld.so.preload"</span><span class="o">)</span><span class="p">;</span><span class="w"> </span><span class="nv">err</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>nil<span class="w"> </span><span class="o">{</span>
<span class="w">        </span>content,<span class="w"> </span>err<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>ioutil.ReadFile<span class="o">(</span><span class="s2">"/etc/ld.so.preload"</span><span class="o">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nv">err</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>nil<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>len<span class="o">(</span>content<span class="o">)</span><span class="w"> </span>&gt;<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="nv">suspiciousFiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>append<span class="o">(</span>suspiciousFiles,<span class="w"> </span><span class="s2">"/etc/ld.so.preload"</span><span class="o">)</span>
<span class="w">        </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>//<span class="w"> </span>Check<span class="w"> </span>/etc/ld.so.conf.d/<span class="w"> </span>directory
<span class="w">    </span>files,<span class="w"> </span>err<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>filepath.Glob<span class="o">(</span><span class="s2">"/etc/ld.so.conf.d/*.conf"</span><span class="o">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nv">err</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>nil<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span>_,<span class="w"> </span>file<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>range<span class="w"> </span>files<span class="w"> </span><span class="o">{</span>
<span class="w">            </span>content,<span class="w"> </span>err<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>ioutil.ReadFile<span class="o">(</span>file<span class="o">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nv">err</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>nil<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>strings.Contains<span class="o">(</span>string<span class="o">(</span>content<span class="o">)</span>,<span class="w"> </span><span class="s2">"LD_PRELOAD"</span><span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">                </span><span class="nv">suspiciousFiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>append<span class="o">(</span>suspiciousFiles,<span class="w"> </span>file<span class="o">)</span>
<span class="w">            </span><span class="o">}</span>
<span class="w">        </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span>len<span class="o">(</span>suspiciousFiles<span class="o">)</span><span class="w"> </span>&gt;<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>suspiciousFiles
<span class="o">}</span>
</code></pre></div>
<p>替换关键系统工具和二进制文件：通过替换常用的系统命令如 ls, ps, netstat 等，使得这些命令在被执行时隐藏特定的信息，例如隐藏特定的文件、进程或网络连接。 这个是一个bash 包装的ps 命令， 可以过滤掉指定进程， 只要把原ps 重命令ps1（可以是其他的字符，只要一致就行）即可。</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># Default list of processes to exclude (you can add more process names here)</span>
<span class="nv">EXCLUDE_PROCESSES</span><span class="o">=(</span><span class="s2">"sshd"</span><span class="w"> </span><span class="s2">"xmr"</span><span class="w"> </span><span class="s2">"miner"</span><span class="o">)</span>

<span class="c1"># Parse options and arguments</span>
<span class="nv">PS_ARGS</span><span class="o">=()</span>
<span class="nv">EXCLUDE_FLAG</span><span class="o">=</span><span class="nb">true</span>

<span class="k">while</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="nv">$#</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="nv">$1</span><span class="w"> </span><span class="k">in</span>
<span class="w">        </span>--exclude<span class="o">)</span>
<span class="w">            </span><span class="nv">EXCLUDE_FLAG</span><span class="o">=</span><span class="nb">true</span>
<span class="w">            </span><span class="nb">shift</span><span class="w"> </span><span class="c1"># Skip the --exclude argument</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">        </span>*<span class="o">)</span>
<span class="w">            </span><span class="nv">PS_ARGS</span><span class="o">+=(</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span><span class="o">)</span><span class="w"> </span><span class="c1"># Collect all other arguments</span>
<span class="w">            </span><span class="nb">shift</span>
<span class="w">            </span><span class="p">;;</span>
<span class="w">    </span><span class="k">esac</span>
<span class="k">done</span>

<span class="c1"># If no arguments are passed, default to 'aux'</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="si">${#</span><span class="nv">PS_ARGS</span><span class="p">[@]</span><span class="si">}</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nv">PS_ARGS</span><span class="o">=(</span><span class="s2">"aux"</span><span class="o">)</span>
<span class="k">fi</span>

<span class="c1"># Execute the ps command and pipe its output to grep</span>
ps1<span class="w"> </span><span class="s2">"</span><span class="si">${</span><span class="nv">PS_ARGS</span><span class="p">[@]</span><span class="si">}</span><span class="s2">"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">"</span><span class="nv">$EXCLUDE_FLAG</span><span class="s2">"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="c1"># Build the grep exclusion pattern</span>
<span class="w">        </span><span class="nv">exclude_pattern</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">"|%s"</span><span class="w"> </span><span class="s2">"</span><span class="si">${</span><span class="nv">EXCLUDE_PROCESSES</span><span class="p">[@]</span><span class="si">}</span><span class="s2">"</span><span class="k">)</span>
<span class="w">        </span><span class="nv">exclude_pattern</span><span class="o">=</span><span class="si">${</span><span class="nv">exclude_pattern</span><span class="p">:</span><span class="nv">1</span><span class="si">}</span><span class="w"> </span><span class="c1"># Remove the leading '|'</span>

<span class="w">        </span><span class="c1"># Use grep to exclude specific process names</span>
<span class="w">        </span>grep<span class="w"> </span>-vE<span class="w"> </span><span class="s2">"</span><span class="nv">$exclude_pattern</span><span class="s2">"</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="c1"># Directly output the ps result</span>
<span class="w">        </span>cat
<span class="w">    </span><span class="k">fi</span>
<span class="o">}</span>
</code></pre></div>
<p>检测 ps 命令有没有被替换, 遍历proc 和 ps 执行结果对比， 代码如下 ：</p>
<div class="highlight"><pre><span></span><code>func<span class="w"> </span>getProcProcesses<span class="o">(</span>minAge<span class="w"> </span>time.Duration<span class="o">)</span><span class="w"> </span><span class="o">(</span>*ProcessMap,<span class="w"> </span>error<span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>procMap<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>NewProcessMap<span class="o">()</span>
<span class="w">    </span>files,<span class="w"> </span>err<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>ioutil.ReadDir<span class="o">(</span><span class="s2">"/proc"</span><span class="o">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>err<span class="w"> </span>!<span class="o">=</span><span class="w"> </span>nil<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span>nil,<span class="w"> </span>fmt.Errorf<span class="o">(</span><span class="s2">"error reading /proc: %v"</span>,<span class="w"> </span>err<span class="o">)</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>now<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>time.Now<span class="o">()</span>.Unix<span class="o">()</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span>_,<span class="w"> </span>f<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>range<span class="w"> </span>files<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span>!f.IsDir<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="k">continue</span>
<span class="w">        </span><span class="o">}</span>

<span class="w">        </span>pid,<span class="w"> </span>err<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>strconv.Atoi<span class="o">(</span>f.Name<span class="o">())</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span>err<span class="w"> </span>!<span class="o">=</span><span class="w"> </span>nil<span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="k">continue</span>
<span class="w">        </span><span class="o">}</span>

<span class="w">        </span>startTime,<span class="w"> </span>err<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>getProcessStartTime<span class="o">(</span>pid<span class="o">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span>err<span class="w"> </span>!<span class="o">=</span><span class="w"> </span>nil<span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="k">continue</span>
<span class="w">        </span><span class="o">}</span>

<span class="w">        </span>//<span class="w"> </span>Skip<span class="w"> </span>processes<span class="w"> </span>running<span class="w"> </span><span class="k">for</span><span class="w"> </span>less<span class="w"> </span>than<span class="w"> </span>minAge
<span class="w">        </span><span class="k">if</span><span class="w"> </span>now-startTime<span class="w"> </span>&lt;<span class="w"> </span>int64<span class="o">(</span>minAge.Seconds<span class="o">())</span><span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="k">continue</span>
<span class="w">        </span><span class="o">}</span>

<span class="w">        </span>statusFile<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>filepath.Join<span class="o">(</span><span class="s2">"/proc"</span>,<span class="w"> </span>f.Name<span class="o">()</span>,<span class="w"> </span><span class="s2">"status"</span><span class="o">)</span>
<span class="w">        </span>content,<span class="w"> </span>err<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>ioutil.ReadFile<span class="o">(</span>statusFile<span class="o">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span>err<span class="w"> </span>!<span class="o">=</span><span class="w"> </span>nil<span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="k">continue</span>
<span class="w">        </span><span class="o">}</span>

<span class="w">        </span>info<span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>ProcessInfo<span class="o">{</span>
<span class="w">            </span>PID:<span class="w">       </span>pid,
<span class="w">            </span>StartTime:<span class="w"> </span>startTime,
<span class="w">            </span>CmdLine:<span class="w">   </span>getCmdLine<span class="o">(</span>pid<span class="o">)</span>,
<span class="w">        </span><span class="o">}</span>

<span class="w">        </span>lines<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>strings.Split<span class="o">(</span>string<span class="o">(</span>content<span class="o">)</span>,<span class="w"> </span><span class="s2">"\n"</span><span class="o">)</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span>_,<span class="w"> </span>line<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>range<span class="w"> </span>lines<span class="w"> </span><span class="o">{</span>
<span class="w">            </span>switch<span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span>strings.HasPrefix<span class="o">(</span>line,<span class="w"> </span><span class="s2">"Name:"</span><span class="o">)</span>:
<span class="w">                </span>info.Name<span class="w"> </span><span class="o">=</span><span class="w"> </span>strings.TrimSpace<span class="o">(</span>strings.TrimPrefix<span class="o">(</span>line,<span class="w"> </span><span class="s2">"Name:"</span><span class="o">))</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span>strings.HasPrefix<span class="o">(</span>line,<span class="w"> </span><span class="s2">"PPid:"</span><span class="o">)</span>:
<span class="w">                </span>info.PPID,<span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>strconv.Atoi<span class="o">(</span>strings.TrimSpace<span class="o">(</span>strings.TrimPrefix<span class="o">(</span>line,<span class="w"> </span><span class="s2">"PPid:"</span><span class="o">)))</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span>strings.HasPrefix<span class="o">(</span>line,<span class="w"> </span><span class="s2">"Uid:"</span><span class="o">)</span>:
<span class="w">                </span>uidFields<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>strings.Fields<span class="o">(</span>strings.TrimPrefix<span class="o">(</span>line,<span class="w"> </span><span class="s2">"Uid:"</span><span class="o">))</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span>len<span class="o">(</span>uidFields<span class="o">)</span><span class="w"> </span>&gt;<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">{</span>
<span class="w">                    </span>info.UID,<span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>strconv.Atoi<span class="o">(</span>uidFields<span class="o">[</span><span class="m">0</span><span class="o">])</span>
<span class="w">                </span><span class="o">}</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span>strings.HasPrefix<span class="o">(</span>line,<span class="w"> </span><span class="s2">"State:"</span><span class="o">)</span>:
<span class="w">                </span>stateParts<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>strings.Fields<span class="o">(</span>strings.TrimPrefix<span class="o">(</span>line,<span class="w"> </span><span class="s2">"State:"</span><span class="o">))</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span>len<span class="o">(</span>stateParts<span class="o">)</span><span class="w"> </span>&gt;<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">{</span>
<span class="w">                    </span>info.State<span class="w"> </span><span class="o">=</span><span class="w"> </span>string<span class="o">(</span>stateParts<span class="o">[</span><span class="m">0</span><span class="o">][</span><span class="m">0</span><span class="o">])</span>
<span class="w">                </span><span class="o">}</span>
<span class="w">            </span><span class="o">}</span>
<span class="w">        </span><span class="o">}</span>

<span class="w">        </span>procMap.Add<span class="o">(</span>pid,<span class="w"> </span>info<span class="o">)</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span>procMap,<span class="w"> </span>nil
<span class="o">}</span>

//<span class="w"> </span>getPsProcesses<span class="w"> </span>retrieves<span class="w"> </span>process<span class="w"> </span>information<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>ps<span class="w"> </span><span class="nb">command</span>
func<span class="w"> </span>getPsProcesses<span class="o">(</span>minAge<span class="w"> </span>time.Duration<span class="o">)</span><span class="w"> </span><span class="o">(</span>*ProcessMap,<span class="w"> </span>error<span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>procMap<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>NewProcessMap<span class="o">()</span>

<span class="w">    </span>//<span class="w"> </span>Use<span class="w"> </span>ps<span class="w"> </span><span class="nb">command</span><span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>more<span class="w"> </span>detailed<span class="w"> </span>information,<span class="w"> </span>including<span class="w"> </span>start<span class="w"> </span><span class="nb">time</span>
<span class="w">    </span>cmd<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>exec.Command<span class="o">(</span><span class="s2">"ps"</span>,<span class="w"> </span><span class="s2">"ax"</span>,<span class="w"> </span><span class="s2">"-o"</span>,<span class="w"> </span><span class="s2">"pid,ppid,uid,stat,lstart,comm"</span><span class="o">)</span>
<span class="w">    </span>output,<span class="w"> </span>err<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>cmd.Output<span class="o">()</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>err<span class="w"> </span>!<span class="o">=</span><span class="w"> </span>nil<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span>nil,<span class="w"> </span>fmt.Errorf<span class="o">(</span><span class="s2">"error executing ps command: %v"</span>,<span class="w"> </span>err<span class="o">)</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>now<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>time.Now<span class="o">()</span>
<span class="w">    </span>scanner<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>bufio.NewScanner<span class="o">(</span>strings.NewReader<span class="o">(</span>string<span class="o">(</span>output<span class="o">)))</span>
<span class="w">    </span>scanner.Scan<span class="o">()</span><span class="w"> </span>//<span class="w"> </span>Skip<span class="w"> </span>header<span class="w"> </span>line

<span class="w">    </span><span class="k">for</span><span class="w"> </span>scanner.Scan<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span>fields<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>strings.Fields<span class="o">(</span>scanner.Text<span class="o">())</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span>len<span class="o">(</span>fields<span class="o">)</span><span class="w"> </span>&lt;<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="k">continue</span>
<span class="w">        </span><span class="o">}</span>

<span class="w">        </span>pid,<span class="w"> </span>err<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>strconv.Atoi<span class="o">(</span>fields<span class="o">[</span><span class="m">0</span><span class="o">])</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span>err<span class="w"> </span>!<span class="o">=</span><span class="w"> </span>nil<span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="k">continue</span>
<span class="w">        </span><span class="o">}</span>

<span class="w">        </span>//<span class="w"> </span>Parse<span class="w"> </span>start<span class="w"> </span><span class="nb">time</span>
<span class="w">        </span>timeStr<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>strings.Join<span class="o">(</span>fields<span class="o">[</span><span class="m">4</span>:9<span class="o">]</span>,<span class="w"> </span><span class="s2">" "</span><span class="o">)</span>
<span class="w">        </span>startTime,<span class="w"> </span>err<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>time.Parse<span class="o">(</span><span class="s2">"Mon Jan 2 15:04:05 2006"</span>,<span class="w"> </span>timeStr<span class="o">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span>err<span class="w"> </span>!<span class="o">=</span><span class="w"> </span>nil<span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="k">continue</span>
<span class="w">        </span><span class="o">}</span>

<span class="w">        </span>//<span class="w"> </span>Skip<span class="w"> </span>processes<span class="w"> </span>running<span class="w"> </span><span class="k">for</span><span class="w"> </span>less<span class="w"> </span>than<span class="w"> </span>minAge
<span class="w">        </span><span class="k">if</span><span class="w"> </span>now.Sub<span class="o">(</span>startTime<span class="o">)</span><span class="w"> </span>&lt;<span class="w"> </span>minAge<span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="k">continue</span>
<span class="w">        </span><span class="o">}</span>

<span class="w">        </span>ppid,<span class="w"> </span>_<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>strconv.Atoi<span class="o">(</span>fields<span class="o">[</span><span class="m">1</span><span class="o">])</span>
<span class="w">        </span>uid,<span class="w"> </span>_<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>strconv.Atoi<span class="o">(</span>fields<span class="o">[</span><span class="m">2</span><span class="o">])</span>

<span class="w">        </span>info<span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>ProcessInfo<span class="o">{</span>
<span class="w">            </span>PID:<span class="w">       </span>pid,
<span class="w">            </span>PPID:<span class="w">      </span>ppid,
<span class="w">            </span>UID:<span class="w">       </span>uid,
<span class="w">            </span>State:<span class="w">     </span>string<span class="o">(</span>fields<span class="o">[</span><span class="m">3</span><span class="o">][</span><span class="m">0</span><span class="o">])</span>,
<span class="w">            </span>StartTime:<span class="w"> </span>startTime.Unix<span class="o">()</span>,
<span class="w">            </span>Name:<span class="w">      </span>fields<span class="o">[</span>len<span class="o">(</span>fields<span class="o">)</span>-1<span class="o">]</span>,
<span class="w">            </span>CmdLine:<span class="w">   </span>getCmdLine<span class="o">(</span>pid<span class="o">)</span>,
<span class="w">        </span><span class="o">}</span>

<span class="w">        </span>procMap.Add<span class="o">(</span>pid,<span class="w"> </span>info<span class="o">)</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span>procMap,<span class="w"> </span>nil
<span class="o">}</span>
</code></pre></div>
<h4>Linux 内核态rootkit检测</h4>
<p>Linux 内核态 rootkit 通过编写自定义的内核模块并将其加载到运行中的内核中，rootkit 可以获得更高的权限和更大的灵活性 。这类 rootkit 通常比用户态的更难检测和移除，因为它们在系统层次上运作，能够绕过大多数用户空间的安全机制。内核态 rootkit主要是修改内核的数据结构或者进行系统函数HOOK来实现隐藏和操控系统的行为, 那么我们内核态rootkit检测就聚焦关注两个点：检测内核特定数据结构有没有被修改，系统函数有没有被替换 。</p>
<p>这个是rootkit 隐藏lkm模块。具体实现如下：</p>
<ul>
<li>记录当前模块的链表前驱节点。</li>
<li>从模块链表中删除当前模块。</li>
<li>记录当前模块的kobject链表前驱节点。</li>
<li>删除模块的kobject。</li>
<li>从kobject链表中删除当前模块。</li>
</ul>
<div class="highlight"><pre><span></span><code>static<span class="w"> </span>struct<span class="w"> </span>list_head<span class="w"> </span>*module_previous<span class="p">;</span>
static<span class="w"> </span>struct<span class="w"> </span>list_head<span class="w"> </span>*module_kobj_previous<span class="p">;</span>
static<span class="w"> </span>char<span class="w"> </span><span class="nv">module_hidden</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>


void<span class="w"> </span>module_hide<span class="o">(</span>void<span class="o">)</span>
<span class="o">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">(</span>module_hidden<span class="o">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="nv">module_previous</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>THIS_MODULE-&gt;list.prev<span class="p">;</span>
<span class="w">    </span>list_del<span class="o">(</span><span class="p">&amp;</span>THIS_MODULE-&gt;list<span class="o">)</span><span class="p">;</span>
<span class="w">    </span><span class="nv">module_kobj_previous</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>THIS_MODULE-&gt;mkobj.kobj.entry.prev<span class="p">;</span>
<span class="w">    </span>kobject_del<span class="o">(</span><span class="p">&amp;</span>THIS_MODULE-&gt;mkobj.kobj<span class="o">)</span><span class="p">;</span>
<span class="w">    </span>list_del<span class="o">(</span><span class="p">&amp;</span>THIS_MODULE-&gt;mkobj.kobj.entry<span class="o">)</span><span class="p">;</span>
<span class="w">    </span><span class="nv">module_hidden</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>!module_hidden<span class="p">;</span>
<span class="o">}</span>
</code></pre></div>
<p>这个是rootkit 将系统调用表中的某个系统调用替换为自定义的函数。具体实现如下:</p>
<ul>
<li>读取并保存当前CR0寄存器值。</li>
<li>将原系统调用保存到orig_fn。</li>
<li>修改CR0寄存器以允许写入系统调用表。</li>
<li>替换系统调用表中的指定系统调用为新函数。</li>
<li>恢复CR0寄存器值。</li>
</ul>
<div class="highlight"><pre><span></span><code>static<span class="w"> </span>inline<span class="w"> </span>void<span class="w"> </span>write_cr0_forced<span class="o">(</span>unsigned<span class="w"> </span>long<span class="w"> </span>val<span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>unsigned<span class="w"> </span>long<span class="w"> </span>__force_order<span class="p">;</span>
<span class="w">    </span>asm<span class="w"> </span>volatile<span class="o">(</span><span class="s2">"mov %0, %%cr0"</span><span class="w"> </span>:<span class="w"> </span><span class="s2">"+r"</span><span class="o">(</span>val<span class="o">)</span>,<span class="w"> </span><span class="s2">"+m"</span><span class="o">(</span>__force_order<span class="o">))</span><span class="p">;</span>
<span class="o">}</span>

void<span class="w"> </span>hook_sys_call_table<span class="o">(</span>long<span class="w"> </span>int<span class="w"> </span>sysno,<span class="w"> </span>t_syscall<span class="w"> </span>hook_fn,
<span class="w">                         </span>t_syscall<span class="w"> </span>*orig_fn<span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>unsigned<span class="w"> </span>long<span class="w"> </span>cr0<span class="p">;</span>
<span class="w">    </span>pr_info<span class="o">(</span>LOG_PREFIX<span class="w"> </span><span class="s2">"hook syscall number %ld"</span>,<span class="w"> </span>sysno<span class="o">)</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">(</span>!sys_call_table_ref<span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span>pr_warn<span class="o">(</span>LOG_PREFIX
<span class="w">                </span><span class="s2">"address of sys_call_table was not found, skip hook\n"</span><span class="o">)</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">    </span><span class="nv">cr0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>read_cr0<span class="o">()</span><span class="p">;</span>
<span class="w">    </span>*orig_fn<span class="w"> </span><span class="o">=</span><span class="w"> </span>sys_call_table_ref<span class="o">[</span>sysno<span class="o">]</span><span class="p">;</span>
<span class="w">    </span>write_cr0_forced<span class="o">(</span>cr0<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>~0x00010000<span class="o">)</span><span class="p">;</span>
<span class="w">    </span>sys_call_table_ref<span class="o">[</span>sysno<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>hook_fn<span class="p">;</span>
<span class="w">    </span>write_cr0_forced<span class="o">(</span>cr0<span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>void<span class="w"> </span>analyze_modules<span class="o">(</span>void<span class="o">){</span>
<span class="w">    </span>struct<span class="w"> </span>kset<span class="w"> </span>*mod_kset<span class="p">;</span>
<span class="w">    </span>struct<span class="w"> </span>kobject<span class="w"> </span>*cur,<span class="w"> </span>*tmp<span class="p">;</span>
<span class="w">    </span>struct<span class="w"> </span>module_kobject<span class="w"> </span>*kobj<span class="p">;</span>

<span class="w">    </span>INFO<span class="o">(</span><span class="s2">"Analyzing Module List\n"</span><span class="o">)</span><span class="p">;</span>

<span class="w">    </span><span class="nv">mod_kset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span>void<span class="w"> </span>*<span class="o">)</span>lookup_name<span class="o">(</span><span class="s2">"module_kset"</span><span class="o">)</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">(</span>!mod_kset<span class="o">)</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>

<span class="w">    </span>list_for_each_entry_safe<span class="o">(</span>cur,<span class="w"> </span>tmp,<span class="w"> </span><span class="p">&amp;</span>mod_kset-&gt;list,<span class="w"> </span>entry<span class="o">){</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">(</span>!kobject_name<span class="o">(</span>tmp<span class="o">))</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>

<span class="w">        </span><span class="nv">kobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>container_of<span class="o">(</span>tmp,<span class="w"> </span>struct<span class="w"> </span>module_kobject,<span class="w"> </span>kobj<span class="o">)</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">(</span>kobj<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>kobj-&gt;mod<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>kobj-&gt;mod-&gt;name<span class="o">){</span>
<span class="w">            </span>mutex_lock<span class="o">(</span><span class="p">&amp;</span>module_mutex<span class="o">)</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="o">(</span>!find_module<span class="o">(</span>kobj-&gt;mod-&gt;name<span class="o">))</span>
<span class="w">                </span>ALERT<span class="o">(</span><span class="s2">"Module [%s] hidden.\n"</span>,<span class="w"> </span>kobj-&gt;mod-&gt;name<span class="o">)</span><span class="p">;</span>
<span class="w">            </span>mutex_unlock<span class="o">(</span><span class="p">&amp;</span>module_mutex<span class="o">)</span><span class="p">;</span>
<span class="w">        </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>void<span class="w"> </span>analyze_syscalls<span class="o">(</span>void<span class="o">){</span>
<span class="w">    </span>int<span class="w"> </span>i<span class="p">;</span>
<span class="w">    </span>const<span class="w"> </span>char<span class="w"> </span>*mod_name<span class="p">;</span>
<span class="w">    </span>unsigned<span class="w"> </span>long<span class="w"> </span>addr<span class="p">;</span>
<span class="w">    </span>struct<span class="w"> </span>module<span class="w"> </span>*mod<span class="p">;</span>

<span class="w">    </span>INFO<span class="o">(</span><span class="s2">"Analyzing Syscall Hooks\n"</span><span class="o">)</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">(</span>!sct<span class="w"> </span><span class="o">||</span><span class="w"> </span>!ckt<span class="o">)</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="o">(</span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span>i<span class="w"> </span>&lt;<span class="w"> </span>NR_syscalls<span class="p">;</span><span class="w"> </span>i++<span class="o">){</span>
<span class="w">        </span><span class="nv">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>sct<span class="o">[</span>i<span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">(</span>!ckt<span class="o">(</span>addr<span class="o">)){</span>
<span class="w">            </span>mutex_lock<span class="o">(</span><span class="p">&amp;</span>module_mutex<span class="o">)</span><span class="p">;</span>
<span class="w">            </span><span class="nv">mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>get_module_from_addr<span class="o">(</span>addr<span class="o">)</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="o">(</span>mod<span class="o">){</span>
<span class="w">                </span>ALERT<span class="o">(</span><span class="s2">"Module [%s] hooked syscall [%d].\n"</span>,<span class="w"> </span>mod-&gt;name,<span class="w"> </span>i<span class="o">)</span><span class="p">;</span>
<span class="w">            </span><span class="o">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="o">{</span>
<span class="w">                </span><span class="nv">mod_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>find_hidden_module<span class="o">(</span>addr<span class="o">)</span><span class="p">;</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="o">(</span>mod_name<span class="o">)</span>
<span class="w">                    </span>ALERT<span class="o">(</span><span class="s2">"Hidden module [%s] hooked syscall [%d].\n"</span>,<span class="w"> </span>mod_name,<span class="w"> </span>i<span class="o">)</span><span class="p">;</span>
<span class="w">            </span><span class="o">}</span>
<span class="w">            </span>mutex_unlock<span class="o">(</span><span class="p">&amp;</span>module_mutex<span class="o">)</span><span class="p">;</span>
<span class="w">        </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>全文完，代码在这里。</p>
<p>https://github.com/njcx/rootkit_scanner</p>
  </div>
</article>
<div id="cyReward" role="cylabs" data-use="reward" style="text-align:center;"></div>
<!--PC和WAP自适应版-->
<div id="SOHUCS" ></div> 
<script type="text/javascript"> 
(function(){ 
var appid = 'cysYUIjwy'; 
var conf = 'prod_71b5e53cad0d27b5ed44fa5219b069b5'; 
var width = window.innerWidth || document.documentElement.clientWidth; 
if (width < 960) { 
window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>

<script type="text/javascript" charset="utf-8" src="https://changyan.itc.cn/js/lib/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="https://changyan.sohu.com/js/changyan.labs.https.js?appid=cysYUIjwy"></script>    </div>
  </div>

  <footer class="footer">
    <div class="container">
      <div class="row">
       <ul class="col-sm-6 list-inline">
          <li class="list-inline-item"><a href="https://www.njcx.bid/authors.html">Authors</a></li>
          <li class="list-inline-item"><a href="https://www.njcx.bid/archives.html">Archives</a></li>
          <li class="list-inline-item"><a href="https://www.njcx.bid/categories.html">Categories</a></li>
          <li class="list-inline-item"><a href="https://www.njcx.bid/tags.html">Tags</a></li>
        </ul>
        <p class="col-sm-6 text-sm-right text-muted">
          本站由 <a href="https://github.com/getpelican/pelican" target="_blank">Pelican 生成</a> 后续 by <a href="https://github.com/njcx" target="_blank">nJcx</a>
        </p>
      </div>
    </div>
  </footer>
</body>

</html>